<!DOCTYPE html>
<html lang="id">
<head>
    <title>Tetris Modern</title>
    <meta name="description" content="Mainkan game Tetris klasik dengan tampilan modern menggunakan Tailwind CSS!">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
          theme: {
            extend: {
              colors: {
                modernBody: '#f3f4f6',
                modernContainer: '#ffffff',
                modernInfoPanel: '#e5e7eb',
                modernCanvas: '#1e293b',
                modernText: '#374151',
                modernButton: '#6b7280',
                modernButtonHover: '#9ca3af',
                modernButtonActive: '#4b5563',
                modernCyan: '#22d3ee',
                modernBlue: '#3b82f6',
                modernOrange: '#f97316',
                modernYellow: '#fde047',
                modernGreen: '#84cc16',
                modernPurple: '#a855f7',
                modernRed: '#ef4444',
              }
            }
          }
        }
    </script>
</head>
<body class="bg-modernBody text-modernText p-5">
    <div id="game-container" class="bg-modernContainer rounded-xl shadow-lg max-w-2xl mx-auto p-4 flex flex-col gap-4">
        <div id="game-info" class="bg-modernInfoPanel rounded-lg shadow-md p-3">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-2xl font-bold">Tetris Modern</h1>
                    <div id="score-level" class="mt-1 text-sm">
                        Score: <span id="score" class="font-semibold">0</span> | 
                        Level: <span id="level" class="font-semibold">1</span>
                    </div>
                </div>
                <div class="flex flex-col items-center">
                    <div class="text-sm">Next Block:</div>
                    <canvas id="next-tetromino-canvas" class="bg-modernCanvas rounded-lg shadow-inner mt-1 w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24"></canvas>
                </div>
            </div>
        </div>
        
        <div class="flex-1">
            <canvas id="tetris-canvas" width="240" height="400" class="bg-modernCanvas rounded-lg shadow-inner w-full max-h-[400px] border border-gray-300"></canvas>
        </div>

        <div id="controls" class="flex flex-wrap justify-center gap-2">
            <button onclick="moveLeft()" class="px-3 py-1.5 bg-modernButton text-white rounded-md shadow-sm hover:bg-modernButtonHover active:bg-modernButtonActive text-sm">Left</button>
            <button onclick="rotate()" class="px-3 py-1.5 bg-modernButton text-white rounded-md shadow-sm hover:bg-modernButtonHover active:bg-modernButtonActive text-sm">Rotate</button>
            <button onclick="moveRight()" class="px-3 py-1.5 bg-modernButton text-white rounded-md shadow-sm hover:bg-modernButtonHover active:bg-modernButtonActive text-sm">Right</button>
            <button onclick="moveDown()" class="px-3 py-1.5 bg-modernButton text-white rounded-md shadow-sm hover:bg-modernButtonHover active:bg-modernButtonActive text-sm">Down</button>
            <button onclick="quickDrop()" class="px-3 py-1.5 bg-modernButton text-white rounded-md shadow-sm hover:bg-modernButtonHover active:bg-modernButtonActive text-sm">Drop</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('tetris-canvas');
        const context = canvas.getContext('2d');
        const nextCanvas = document.getElementById('next-tetromino-canvas');
        const nextContext = nextCanvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const levelElement = document.getElementById('level');

        let grid = 20;
        let score = 0;
        let level = 1;
        let linesCleared = 0;
        let gameSpeed = 700;
        let gameInterval;

        const colors = [null, '#22d3ee', '#3b82f6', '#f97316', '#fde047', '#84cc16', '#a855f7', '#ef4444'];
        const shapes = [
            [], 
            [[1,1,1,1]], 
            [[1,1,0],[0,1,1]], 
            [[0,1,1],[1,1,0]], 
            [[1,1,1],[0,1,0]], 
            [[1,1],[1,1]], 
            [[1,0],[1,0],[1,1]], 
            [[0,1],[0,1],[1,1]]
        ];

        let playfield = Array.from({ length: 20 }, () => Array(12).fill(0));
        let tetromino, nextTetromino, position;

        function getNewTetromino() {
            let rand = Math.floor(Math.random() * 7) + 1;
            return { shape: shapes[rand], color: colors[rand] };
        }

        function resetTetromino() {
            tetromino = nextTetromino;
            nextTetromino = getNewTetromino();
            position = { x: 5, y: 0 };

            if (isColliding()) {
                clearInterval(gameInterval);
                alert(`Game Over! Score: ${score}`);
            }
        }

        function isColliding() {
            return tetromino.shape.some((row, y) => row.some((cell, x) => cell && playfield[position.y + y]?.[position.x + x]));
        }

        function moveTetromino(dx, dy) {
            position.x += dx;
            position.y += dy;
            if (isColliding()) position.y -= dy;
        }

        function rotateTetromino() {
            let rotated = tetromino.shape[0].map((_, x) => tetromino.shape.map(row => row[x]).reverse());
            let oldShape = tetromino.shape;
            tetromino.shape = rotated;
            if (isColliding()) tetromino.shape = oldShape;
        }

        function placeTetromino() {
            tetromino.shape.forEach((row, y) => row.forEach((cell, x) => {
                if (cell) playfield[position.y + y][position.x + x] = colors.indexOf(tetromino.color);
            }));
            resetTetromino();
        }

        function gameLoop() {
            moveTetromino(0, 1);
            if (isColliding()) {
                position.y--;
                placeTetromino();
            }
            draw();
        }

        function startGame() {
            gameInterval = setInterval(gameLoop, gameSpeed);
            resetTetromino();
            draw();
        }

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') moveTetromino(-1, 0);
            else if (e.key === 'ArrowRight') moveTetromino(1, 0);
            else if (e.key === 'ArrowDown') moveTetromino(0, 1);
            else if (e.key === 'ArrowUp') rotateTetromino();
            draw();
        });

        document.addEventListener('DOMContentLoaded', startGame);
    </script>
</body>
</html>
